<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archipelago Dashboard - Sistema de Gest√£o Hospitalar</title>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- QRCode Generator -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    
    <!-- QR Scanner -->
    <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
    
    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Container Principal -->
    <div id="app">
        <!-- Tela de Login -->
        <div id="loginScreen" class="login-screen">
            <div class="login-container">
                <div class="login-header">
                    <img src="https://i.ibb.co/7G3Kzps/1.png" alt="Archipelago Logo" class="login-logo">
                    <h1>Archipelago Dashboard</h1>
                    <p>Sistema de Gest√£o Hospitalar</p>
                </div>
                <div class="login-form">
                    <input type="password" id="passwordInput" placeholder="Digite a senha de acesso" maxlength="6">
                    <button onclick="authenticate()" id="loginBtn">ENTRAR</button>
                    <div id="loginError" class="error-message"></div>
                </div>
            </div>
        </div>

        <!-- Container Principal Ap√≥s Login -->
        <div id="mainApp" class="main-app" style="display: none;">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <button class="menu-toggle" onclick="toggleSidebar()">‚ò∞</button>
                    <img src="https://i.ibb.co/7G3Kzps/1.png" alt="Logo" class="header-logo">
                    <h1>Archipelago Dashboard</h1>
                </div>
                <div class="header-right">
                    <span id="currentDateTime"></span>
                    <button onclick="logout()" class="logout-btn">Sair</button>
                </div>
            </header>

            <!-- Sidebar -->
            <aside id="sidebar" class="sidebar">
                <nav class="nav-menu">
                    <button onclick="switchView('cards')" class="nav-btn active" data-view="cards">
                        <span class="icon">üè•</span>
                        <span>Gest√£o de Leitos</span>
                    </button>
                    <button onclick="switchView('dashboard-exec')" class="nav-btn" data-view="dashboard-exec">
                        <span class="icon">üìä</span>
                        <span>Dashboard Executivo</span>
                    </button>
                    <button onclick="switchView('dashboard-hosp')" class="nav-btn" data-view="dashboard-hosp">
                        <span class="icon">üìà</span>
                        <span>Dashboard Hospitalar</span>
                    </button>
                    <button onclick="switchView('qrcode')" class="nav-btn" data-view="qrcode">
                        <span class="icon">üì±</span>
                        <span>QR Code Scanner</span>
                    </button>
                    
                    <div class="nav-separator"></div>
                    
                    <button onclick="switchView('config')" class="nav-btn" data-view="config">
                        <span class="icon">‚öôÔ∏è</span>
                        <span>Configura√ß√µes</span>
                    </button>
                </nav>
            </aside>

            <!-- Main Content -->
            <main id="mainContent" class="main-content">
                <!-- View: Cards (Gest√£o de Leitos) -->
                <div id="cardsView" class="view-container active">
                    <div class="view-header">
                        <h2>Gest√£o de Leitos Hospitalares</h2>
                        <div class="header-stats">
                            <div class="stat-badge ocupado">
                                <span>Ocupados</span>
                                <strong id="totalOcupados">0</strong>
                            </div>
                            <div class="stat-badge vago">
                                <span>Vagos</span>
                                <strong id="totalVagos">0</strong>
                            </div>
                            <div class="stat-badge total">
                                <span>Total</span>
                                <strong id="totalLeitos">49</strong>
                            </div>
                        </div>
                    </div>
                    <div id="cardsContainer" class="cards-container"></div>
                </div>

                <!-- View: Dashboard Executivo -->
                <div id="dashboardExecView" class="view-container" style="display: none;">
                    <div class="view-header">
                        <h2>Dashboard Executivo - Rede Hospitalar Externa</h2>
                    </div>
                    
                    <!-- KPIs Row -->
                    <div class="kpis-row">
                        <div class="kpi-card">
                            <div class="kpi-label">Taxa de Ocupa√ß√£o</div>
                            <div class="kpi-value" id="kpiOcupacao">0%</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-label">M√©dia PPS</div>
                            <div class="kpi-value" id="kpiPPS">0%</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-label">Previs√£o Altas Hoje</div>
                            <div class="kpi-value" id="kpiAltasHoje">0</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-label">Tempo M√©dio</div>
                            <div class="kpi-value" id="kpiTempoMedio">0d</div>
                        </div>
                    </div>

                    <!-- Gauge e Gr√°ficos -->
                    <div class="dashboard-grid">
                        <div class="chart-box">
                            <h3>Taxa de Ocupa√ß√£o Geral</h3>
                            <canvas id="gaugeChart"></canvas>
                        </div>
                        <div class="chart-box">
                            <h3>Ocupa√ß√£o por Hospital</h3>
                            <canvas id="ocupacaoHospitalChart"></canvas>
                        </div>
                        <div class="chart-box">
                            <h3>Concess√µes por Hospital</h3>
                            <canvas id="concessoesChart"></canvas>
                        </div>
                        <div class="chart-box">
                            <h3>Linhas de Cuidado</h3>
                            <canvas id="linhasCuidadoChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- View: Dashboard Hospitalar -->
                <div id="dashboardHospView" class="view-container" style="display: none;">
                    <div class="view-header">
                        <h2>Dashboard Hospitalar - An√°lise Detalhada</h2>
                    </div>
                    <div id="hospitalDashboards"></div>
                </div>

                <!-- View: QR Code Scanner -->
                <div id="qrcodeView" class="view-container" style="display: none;">
                    <div class="view-header">
                        <h2>Scanner de QR Code</h2>
                    </div>
                    <div class="qr-container">
                        <div id="qr-reader"></div>
                        <div id="qr-result" class="qr-result"></div>
                    </div>
                </div>

                <!-- View: Configura√ß√µes -->
                <div id="configView" class="view-container" style="display: none;">
                    <div class="view-header">
                        <h2>Configura√ß√µes do Sistema</h2>
                    </div>
                    <div class="config-grid">
                        <div class="config-section">
                            <h3>üé® Personaliza√ß√£o de Cores</h3>
                            <div class="color-controls">
                                <div class="color-group">
                                    <label>Cor Principal (Header)</label>
                                    <input type="color" id="corHeader" value="#3b82f6">
                                </div>
                                <div class="color-group">
                                    <label>Cor Menu Lateral</label>
                                    <input type="color" id="corSidebar" value="#60a5fa">
                                </div>
                                <div class="color-group">
                                    <label>Cor de Destaque</label>
                                    <input type="color" id="corDestaque" value="#10b981">
                                </div>
                                <button onclick="aplicarCores()" class="btn-primary">Aplicar Cores</button>
                                <button onclick="restaurarCores()" class="btn-secondary">Restaurar Padr√£o</button>
                            </div>
                        </div>

                        <div class="config-section">
                            <h3>üë®‚Äçüíº √Årea Administrativa</h3>
                            <button onclick="openADM()" class="btn-config">
                                <span class="icon">üîê</span>
                                Acessar Painel ADM
                            </button>
                        </div>

                        <div class="config-section">
                            <h3>üì± QR Codes</h3>
                            <button onclick="gerarQRCodes()" class="btn-config">
                                <span class="icon">üì±</span>
                                Gerar QR Codes dos Leitos
                            </button>
                        </div>

                        <div class="config-section">
                            <h3>üìä Relat√≥rios</h3>
                            <button onclick="exportarDados()" class="btn-config">
                                <span class="icon">üì•</span>
                                Exportar Dados (Excel)
                            </button>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Modais -->
    <!-- Modal de Admiss√£o -->
    <div id="modalAdmissao" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Nova Admiss√£o</h2>
                <button class="modal-close" onclick="closeModal('modalAdmissao')">&times;</button>
            </div>
            <form id="formAdmissao" class="modal-form">
                <div class="form-row">
                    <div class="form-group">
                        <label>Nome do Paciente*</label>
                        <input type="text" name="nome" required>
                    </div>
                    <div class="form-group">
                        <label>Idade*</label>
                        <input type="number" name="idade" min="0" max="150" required>
                    </div>
                    <div class="form-group">
                        <label>Registro*</label>
                        <input type="text" name="registro" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Data de Entrada*</label>
                        <input type="date" name="dataEntrada" required>
                    </div>
                    <div class="form-group">
                        <label>M√©dico Respons√°vel*</label>
                        <input type="text" name="medico" required>
                    </div>
                    <div class="form-group">
                        <label>PPS (%)*</label>
                        <select name="pps" required>
                            <option value="">Selecione</option>
                            <option value="10">10%</option>
                            <option value="20">20%</option>
                            <option value="30">30%</option>
                            <option value="40">40%</option>
                            <option value="50">50%</option>
                            <option value="60">60%</option>
                            <option value="70">70%</option>
                            <option value="80">80%</option>
                            <option value="90">90%</option>
                            <option value="100">100%</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Diagn√≥stico*</label>
                        <input type="text" name="diagnostico" required>
                    </div>
                    <div class="form-group">
                        <label>Conv√™nio</label>
                        <input type="text" name="convenio">
                    </div>
                    <div class="form-group">
                        <label>Previs√£o de Alta</label>
                        <select name="previsaoAlta">
                            <option value="">N√£o definida</option>
                            <option value="Hoje Ouro">Hoje Ouro</option>
                            <option value="Hoje 2R">Hoje 2R</option>
                            <option value="Hoje 3R">Hoje 3R</option>
                            <option value="24h">24 horas</option>
                            <option value="48h">48 horas</option>
                            <option value="72h">72 horas</option>
                            <option value=">72h">Mais de 72h</option>
                        </select>
                    </div>
                </div>

                <div class="form-section">
                    <h3>CONCESS√ïES PREVISTAS NA ALTA</h3>
                    <div class="checkbox-grid">
                        <label class="checkbox-label">
                            <input type="checkbox" name="concessoes" value="√ìrtese/Pr√≥tese">
                            <span>√ìrtese/Pr√≥tese</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="concessoes" value="Equipamento">
                            <span>Equipamento</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="concessoes" value="Dieta">
                            <span>Dieta</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="concessoes" value="Medicamento Alto Custo">
                            <span>Medicamento Alto Custo</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="concessoes" value="Transporte">
                            <span>Transporte</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="concessoes" value="Outros">
                            <span>Outros</span>
                        </label>
                    </div>
                </div>

                <div class="form-section">
                    <h3>LINHA DE CUIDADOS PROPOSTA NA ALTA</h3>
                    <div class="checkbox-grid">
                        <label class="checkbox-label">
                            <input type="checkbox" name="linhaCuidado" value="Unidade B√°sica">
                            <span>Unidade B√°sica</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="linhaCuidado" value="Ambulat√≥rio de Egressos">
                            <span>Ambulat√≥rio de Egressos</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="linhaCuidado" value="CAPS">
                            <span>CAPS</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="linhaCuidado" value="Resid√™ncia Terap√™utica">
                            <span>Resid√™ncia Terap√™utica</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="linhaCuidado" value="Hospital Dia">
                            <span>Hospital Dia</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="linhaCuidado" value="Outros">
                            <span>Outros</span>
                        </label>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group full-width">
                        <label>Observa√ß√µes</label>
                        <textarea name="observacoes" rows="3"></textarea>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" onclick="closeModal('modalAdmissao')" class="btn-secondary">Cancelar</button>
                    <button type="submit" class="btn-primary">Confirmar Admiss√£o</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Atualiza√ß√£o (estrutura similar) -->
    <div id="modalAtualizacao" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Atualizar Informa√ß√µes do Leito</h2>
                <button class="modal-close" onclick="closeModal('modalAtualizacao')">&times;</button>
            </div>
            <form id="formAtualizacao" class="modal-form">
                <!-- Mesmo conte√∫do do form de admiss√£o -->
            </form>
        </div>
    </div>

    <!-- Modal de Alta -->
    <div id="modalAlta" class="modal">
        <div class="modal-content modal-compact">
            <div class="modal-header">
                <h2>Confirmar Alta do Paciente</h2>
                <button class="modal-close" onclick="closeModal('modalAlta')">&times;</button>
            </div>
            <div class="modal-body">
                <p>Confirma a alta do paciente <strong id="altaPacienteNome"></strong>?</p>
                <div class="form-group">
                    <label>Data da Alta</label>
                    <input type="datetime-local" id="dataAlta" required>
                </div>
                <div class="form-group">
                    <label>Motivo da Alta</label>
                    <select id="motivoAlta">
                        <option value="Melhora Cl√≠nica">Melhora Cl√≠nica</option>
                        <option value="Transfer√™ncia">Transfer√™ncia</option>
                        <option value="√ìbito">√ìbito</option>
                        <option value="Evas√£o">Evas√£o</option>
                        <option value="Alta a Pedido">Alta a Pedido</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button onclick="closeModal('modalAlta')" class="btn-secondary">Cancelar</button>
                <button onclick="confirmarAlta()" class="btn-primary">Confirmar Alta</button>
            </div>
        </div>
    </div>

    <!-- Modal ADM -->
    <div id="modalADM" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Painel Administrativo</h2>
                <button class="modal-close" onclick="closeModal('modalADM')">&times;</button>
            </div>
            <div class="adm-login" id="admLogin">
                <h3>Autentica√ß√£o Administrativa</h3>
                <input type="email" id="admEmail" placeholder="Email" value="cvcalessandro@gmail.com">
                <input type="password" id="admPassword" placeholder="Senha">
                <button onclick="loginADM()" class="btn-primary">Entrar</button>
            </div>
            <div class="adm-panel" id="admPanel" style="display: none;">
                <h3>Gest√£o de Hospitais e Leitos</h3>
                <div id="admContent"></div>
            </div>
        </div>
    </div>

    <!-- Modal QR Codes -->
    <div id="modalQRCodes" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>QR Codes dos Leitos</h2>
                <button class="modal-close" onclick="closeModal('modalQRCodes')">&times;</button>
            </div>
            <div id="qrCodesGrid" class="qr-codes-grid"></div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="app.js"></script>
</body>
</html>
